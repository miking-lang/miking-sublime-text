%YAML 1.2
---
name: MCore
file_extensions:
  - mc
scope: source.mcore

# To whoever is reading this:
# Due to the parsing nature of MCore not being very LL1-focused, this syntax
# highlighter uses a fragment system to generate the final .sublime-syntax file
# to avoid a lot of code duplication. If you know of a way to achieve the same
# result without using a custom fragment system, please let me know. /John

variables:
  builtin_ident: '(?:unit|not|and|or|addi|subi|muli|divi|modi|negi|lti|leqi|gti|geqi|eqi|neqi|slli|srli|srai|arity|addf|subf|mulf|divf|negf|ltf|leqf|gtf|geqf|eqf|neqf|char2int|int2char|int2float|string2float|length|concat|nth|cons|snoc|slice|reverse|print|dprint|argv|readFile|writeFile|fileExists|deleteFile|error|floorfi|ceilfi|roundfi|get|set|splitAt|makeSeq)'
  reserved_ident: '(?:if|then|else|let|match|with|lang|con|use|in|case|utest|lam)'
  type_ident: '(?:Dyn|Bool|Int|Float|Char|String)'
  ident: '(?:[a-zA-Z_][a-zA-Z_0-9]*)'
  escapechar: '(?:\\(?:[?abfnrtv"\\]|''))'

# Context parsing
contexts:
  prototype:
    - include: comment
    - include: illegal-open-rparen
    - include: illegal-open-rsquare
    - include: illegal-open-rcurly

  prototype-ignore-rparen:
    - include: comment
    - include: illegal-open-rsquare
    - include: illegal-open-rcurly

  prototype-ignore-rsquare:
    - include: comment
    - include: illegal-open-rparen
    - include: illegal-open-rcurly

  prototype-ignore-rcurly:
    - include: comment
    - include: illegal-open-rparen
    - include: illegal-open-rsquare

  main:
    - include: top-level

  top-level:
    - include: top-include
    - include: top-lang
    - include: top-let
    - include: top-recursive
    - include: top-con
    - include: top-type
    - include: top-mexpr

  top-level-pushed:
    - include: top-include-pushed
    - include: top-lang-pushed
    - include: top-let-pushed
    - include: top-recursive-pushed
    - include: top-con-pushed
    - include: top-type-pushed
    - include: top-mexpr-pushed

  ###          ###
  ### Comments ###
  ###          ###
  comment:
    - match: '(--|//)'
      scope: comment.line.mcore
      push:
        - match: '\n'
          scope: comment.line.mcore
          pop: true
        - include: comment-line-content
  comment-line-content:
    - match: '.*'
      scope: comment.line.mcore

  ###                                             ###
  ### Illegal RParen/RSquareBracket/RCurlyBracket ###
  ###                                             ###
  illegal-open-rparen:
    - match: '\)'
      scope: invalid.illegal.rparen.mcore
  illegal-open-rsquare:
    - match: '\]'
      scope: invalid.illegal.rsquare.mcore
  illegal-open-rcurly:
    - match: '\}'
      scope: invalid.illegal.rcurly.mcore

  ###                               ###
  ### Top-Level Include Expressions ###
  ###                               ###
  top-include:
    - match: '\b(include)\b'
      scope: keyword.directive.include.mcore
      push: [string-pushed]

  top-include-pushed:
    - match: '\b(include)\b'
      scope: keyword.directive.include.mcore
      set: [string-pushed]

  ###                            ###
  ### Top-Level Lang Expressions ###
  ###                            ###
  top-lang:
    - match: '\b(lang)\b'
      scope: keyword.directive.lang.mcore
      push: [top-lang-entry-pushed, identifier-pushed]

  top-lang-pushed:
    - match: '\b(lang)\b'
      scope: keyword.directive.lang.mcore
      set: [top-lang-entry-pushed, identifier-pushed]

  top-lang-entry-pushed:
      # Check what comes after 'lang'
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      set: [top-lang-eqexpr-pushed, identifier-pushed]
    - include: top-lang-syn-entry-pushed
    - include: top-lang-sem-entry-pushed
    - include: top-lang-end-pushed
    - include: top-level-pushed

  top-lang-eqexpr-pushed:
      # lang X = ...
    - match: '(\+)'
      scope: keyword.operator.combine.mcore
      set: [top-lang-eqexpr-pushed, identifier-pushed]
    - include: top-lang-syn-entry-pushed
    - include: top-lang-sem-entry-pushed
    - include: top-lang-end-pushed
    - include: top-level-pushed

  top-lang-end-pushed:
    - match: '\b(end)\b'
      scope: keyword.directive.end.mcore
      pop: true

  top-lang-syn-entry-pushed:
    - match: '\b(syn)\b'
      scope: keyword.other.syn.mcore
      set: [top-lang-syn-body-pushed, eqoperator-pushed, identifier-pushed]

  top-lang-syn-body-pushed:
    - match: '(\|)'
      scope: keyword.operator.case.mcore
      set: [typeexpr-pushed-breaksynbody, identifier-pushed]
    - include: top-lang-syn-entry-pushed
    - include: top-lang-sem-entry-pushed
    - include: top-lang-end-pushed

  top-lang-sem-entry-pushed:
    - match: '\b(sem)\b'
      scope: keyword.other.sem.mcore
      set: [top-lang-sem-preamble-pushed, identifier-pushed]

  top-lang-sem-preamble-pushed:
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      set: [top-lang-sem-body-pushed]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [top-lang-sem-preamble-pushed, typeexpr-pushed-breakrparen, colon-pushed, identifier-pushed]

  top-lang-sem-body-pushed:
    - match: '(\|)'
      scope: keyword.operator.case.mcore
      set: [mexpr-pushed-breaksembody, pattern-pushed-breakrightarrow]
    - include: top-lang-syn-entry-pushed
    - include: top-lang-sem-entry-pushed
    - include: top-lang-end-pushed

  ###                           ###
  ### Top-Level Let Expressions ###
  ###                           ###
  top-let:
    - match: '\b(let)\b'
      scope: keyword.directive.let.mcore
      push: [mexpr-pushed-breaktoplevel, optidenttype-pushed-breakeq, identifier-pushed]

  top-let-pushed:
    - match: '\b(let)\b'
      scope: keyword.directive.let.mcore
      set: [mexpr-pushed-breaktoplevel, optidenttype-pushed-breakeq, identifier-pushed]

  ###                                 ###
  ### Top-Level Recursive Expressions ###
  ###                                 ###
  top-recursive:
    - match: '\b(recursive)\b'
      scope: keyword.directive.recursive.mcore
      push: [top-recursive-body-pushed]

  top-recursive-pushed:
    - match: '\b(recursive)\b'
      scope: keyword.directive.recursive.mcore
      set: [top-recursive-body-pushed]

  top-recursive-body-pushed:
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breaktoprecbody, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(end)\b'
      scope: keyword.directive.end.mcore
      pop: true

  ###                           ###
  ### Top-Level Con Expressions ###
  ###                           ###
  top-con:
    - match: '\b(con)\b'
      scope: keyword.directive.con.mcore
      push: [optidenttype-pushed-breaktoplevel, identifier-pushed]

  top-con-pushed:
    - match: '\b(con)\b'
      scope: keyword.directive.con.mcore
      set: [optidenttype-pushed-breaktoplevel, identifier-pushed]

  ###                            ###
  ### Top-Level Type Expressions ###
  ###                            ###
  top-type:
    - match: '\b(type)\b'
      scope: keyword.directive.type.mcore
      push: [opttypetype-pushed-breaktoplevel, identifier-pushed]

  top-type-pushed:
    - match: '\b(type)\b'
      scope: keyword.directive.type.mcore
      set: [opttypetype-pushed-breaktoplevel, identifier-pushed]

  ###                             ###
  ### Top-Level MExpr Expressions ###
  ###                             ###
  top-mexpr:
    - match: '\b(mexpr)\b'
      scope: keyword.directive.mexpr.mcore
      push: [mexpr-pushed-breaktoplevel]

  top-mexpr-pushed:
    - match: '\b(mexpr)\b'
      scope: keyword.directive.mexpr.mcore
      set: [mexpr-pushed-breaktoplevel]

  ###                   ###
  ### MExpr Expressions ###
  ###                   ###
  mexpr-pushed-breaktoplevel:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breaktoplevel, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breaktoplevel, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breaktoplevel, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breaktoplevel, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breaktoplevel, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breaktoplevel, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breaktoplevel, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breaktoplevel, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breaktoplevel, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breaktoplevel
  mexpr-pushed-breakrecbody:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakrecbody, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakrecbody, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakrecbody, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakrecbody, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakrecbody, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakrecbody, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakrecbody, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakrecbody, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakrecbody, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakrecbody
  mexpr-pushed-breaktoprecbody:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breaktoprecbody, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breaktoprecbody, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breaktoprecbody, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breaktoprecbody, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breaktoprecbody, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breaktoprecbody, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breaktoprecbody, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breaktoprecbody, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breaktoprecbody, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breaktoprecbody
  mexpr-pushed-breaktuple:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breaktuple, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breaktuple, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breaktuple, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breaktuple, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breaktuple, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breaktuple, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breaktuple, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breaktuple, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breaktuple, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breaktuple
  mexpr-pushed-breakseq:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakseq, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakseq, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakseq, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakseq, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakseq, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakseq, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakseq, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakseq, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakseq, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakseq
  mexpr-pushed-breakrecordcontinued:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakrecordcontinued, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakrecordcontinued, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakrecordcontinued, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakrecordcontinued, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakrecordcontinued, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakrecordcontinued, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakrecordcontinued, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakrecordcontinued, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakrecordcontinued, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakrecordcontinued
  mexpr-pushed-breakrecordwith:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakrecordwith, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakrecordwith, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakrecordwith, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakrecordwith, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakrecordwith, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakrecordwith, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakrecordwith, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakrecordwith, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakrecordwith, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakrecordwith
  mexpr-pushed-breakrecordend:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakrecordend, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakrecordend, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakrecordend, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakrecordend, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakrecordend, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakrecordend, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakrecordend, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakrecordend, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakrecordend, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakrecordend
  mexpr-pushed-breaksembody:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breaksembody, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breaksembody, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breaksembody, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breaksembody, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breaksembody, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breaksembody, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breaksembody, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breaksembody, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breaksembody, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breaksembody
  mexpr-pushed-breakin:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakin, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakin, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakin, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakin, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakin, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakin, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakin, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakin, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakin, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakin
  mexpr-pushed-breakthen:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakthen, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakthen, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakthen, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakthen, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakthen, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakthen, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakthen, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakthen, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakthen, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakthen
  mexpr-pushed-breakelse:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakelse, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakelse, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakelse, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakelse, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakelse, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakelse, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakelse, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakelse, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakelse, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakelse
  mexpr-pushed-breakwith:
    - match: '\b(con)\b'
      scope: keyword.other.con.mcore
      set: [mexpr-pushed-breakwith, optidenttype-pushed-breakin, identifier-pushed]
    - match: '\b(if)\b'
      scope: keyword.other.if.mcore
      set: [mexpr-pushed-breakwith, mexpr-pushed-breakelse, mexpr-pushed-breakthen]
    - match: '\b(lam)\b'
      scope: keyword.other.lam.mcore
      set: [mexpr-pushed-breakwith, optidenttype-pushed-breakdot, identifier-pushed]
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakwith, mexpr-pushed-breakin, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(match)\b'
      scope: keyword.other.match.mcore
      set: [mexpr-pushed-breakwith, mexpr-pushed-breakelse, pattern-pushed-breakthen, mexpr-pushed-breakwith]
    - match: '\b(recursive)\b'
      scope: keyword.other.recursive.mcore
      set: [mexpr-pushed-breakwith, recursive-body-pushed]
    - match: '\b(type)\b'
      scope: keyword.other.type.mcore
      set: [mexpr-pushed-breakwith, opttypetype-pushed-breakin, identifier-pushed]
    - match: '\b(use)\b'
      scope: keyword.other.use.mcore
      set: [mexpr-pushed-breakwith, directive-in-pushed, identifier-pushed]
    - match: '\b(utest)\b'
      scope: keyword.other.utest.mcore
      set: [mexpr-pushed-breakwith, mexpr-pushed-breakin, mexpr-pushed-breakwith]
    - include: atoms-pushed-mandatory-breakwith

  ###             ###
  ### MExpr Atoms ###
  ###             ###
  atoms-pushed-mandatory-breaktoplevel:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoplevel]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoplevel]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktoplevel, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktoplevel, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktoplevel, record-entry-pushed]
  atoms-pushed-breaktoplevel:
    - include: top-level-pushed
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoplevel]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktoplevel]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoplevel]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktoplevel, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktoplevel, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktoplevel, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breaktoplevel, record-proj-label-pushed]
  atoms-pushed-mandatory-breakrecbody:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecbody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecbody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecbody, record-entry-pushed]
  atoms-pushed-breakrecbody:
    - include: recursive-body-pushed
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecbody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecbody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecbody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecbody, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakrecbody, record-proj-label-pushed]
  atoms-pushed-mandatory-breaktoprecbody:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoprecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoprecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktoprecbody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktoprecbody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktoprecbody, record-entry-pushed]
  atoms-pushed-breaktoprecbody:
    - include: top-recursive-body-pushed
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoprecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktoprecbody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktoprecbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktoprecbody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktoprecbody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktoprecbody, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breaktoprecbody, record-proj-label-pushed]
  atoms-pushed-mandatory-breaktuple:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktuple]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktuple, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktuple, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktuple, record-entry-pushed]
  atoms-pushed-breaktuple:
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - match: '\)'
      scope: symbol.rparen.mcore
      pop: true
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [mexpr-pushed-breaktuple]
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaktuple]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaktuple]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaktuple]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaktuple, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaktuple, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaktuple, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breaktuple, record-proj-label-pushed]
  atoms-pushed-mandatory-breakseq:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakseq]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakseq]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakseq]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakseq, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakseq, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakseq, record-entry-pushed]
  atoms-pushed-breakseq:
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - match: '\]'
      scope: symbol.rsquare.mcore
      pop: true
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [mexpr-pushed-breakseq]
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakseq]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakseq]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakseq]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakseq]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakseq]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakseq, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakseq, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakseq, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakseq, record-proj-label-pushed]
  atoms-pushed-mandatory-breakrecordcontinued:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordcontinued]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordcontinued]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordcontinued, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordcontinued, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordcontinued, record-entry-pushed]
  atoms-pushed-breakrecordcontinued:
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - match: '\}'
      scope: symbol.rcurly.mcore
      pop: true
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [mexpr-pushed-breakrecordcontinued, eqoperator-pushed, identifier-pushed]
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordcontinued]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordcontinued]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordcontinued]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordcontinued, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordcontinued, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordcontinued, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakrecordcontinued, record-proj-label-pushed]
  atoms-pushed-mandatory-breakrecordwith:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordwith, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordwith, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordwith, record-entry-pushed]
  atoms-pushed-breakrecordwith:
    - match: '\b(with)\b'
      scope: keyword.other.with.mcore
      set: [mexpr-pushed-breakrecordend]
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordwith]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordwith, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordwith, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordwith, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakrecordwith, record-proj-label-pushed]
  atoms-pushed-mandatory-breakrecordend:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordend]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordend]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordend, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordend, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordend, record-entry-pushed]
  atoms-pushed-breakrecordend:
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - match: '\}'
      scope: symbol.rcurly.mcore
      pop: true
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordend]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakrecordend]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakrecordend]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakrecordend, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakrecordend, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakrecordend, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakrecordend, record-proj-label-pushed]
  atoms-pushed-mandatory-breaksembody:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaksembody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaksembody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaksembody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaksembody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaksembody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaksembody, record-entry-pushed]
  atoms-pushed-breaksembody:
    - include: top-lang-sem-body-pushed
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaksembody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breaksembody]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breaksembody]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breaksembody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breaksembody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breaksembody, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breaksembody, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breaksembody, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breaksembody, record-proj-label-pushed]
  atoms-pushed-mandatory-breakin:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakin]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakin]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakin]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakin]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakin]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakin, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakin, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakin, record-entry-pushed]
  atoms-pushed-breakin:
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakin]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakin]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakin]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakin]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakin]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakin]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakin]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakin, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakin, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakin, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakin, record-proj-label-pushed]
  atoms-pushed-mandatory-breakthen:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakthen]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakthen]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakthen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakthen, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakthen, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakthen, record-entry-pushed]
  atoms-pushed-breakthen:
    - match: '\b(then)\b'
      scope: keyword.other.then.mcore
      pop: true
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakthen]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakthen]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakthen]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakthen]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakthen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakthen, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakthen, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakthen, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakthen, record-proj-label-pushed]
  atoms-pushed-mandatory-breakelse:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakelse]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakelse]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakelse]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakelse]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakelse]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakelse, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakelse, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakelse, record-entry-pushed]
  atoms-pushed-breakelse:
    - match: '\b(else)\b'
      scope: keyword.other.else.mcore
      pop: true
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakelse]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakelse]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakelse]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakelse]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakelse]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakelse]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakelse]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakelse, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakelse, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakelse, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakelse, record-proj-label-pushed]
  atoms-pushed-mandatory-breakwith:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakwith]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakwith]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakwith]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakwith, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakwith, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakwith, record-entry-pushed]
  atoms-pushed-breakwith:
    - match: '\b(with)\b'
      scope: keyword.other.with.mcore
      pop: true
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(never)\b'
      scope: constant.language.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [atoms-pushed-breakwith]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [atoms-pushed-breakwith]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [atoms-pushed-breakwith]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [atoms-pushed-breakwith]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [atoms-pushed-breakwith]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [atoms-pushed-breakwith]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\('
      scope: symbol.lparen.mcore
      set: [atoms-pushed-breakwith, mexpr-pushed-breaktuple]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [atoms-pushed-breakwith, mexpr-pushed-breakseq]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [atoms-pushed-breakwith, record-entry-pushed]
    - match: '[.]'
      scope: symbol.dot.mcore
      set: [atoms-pushed-breakwith, record-proj-label-pushed]

  ###                  ###
  ### Type Expressions ###
  ###                  ###
  typeexpr-pushed-breakrparen:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breakrparen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrparen, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breakrparen:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakrparen]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - match: '\)'
      scope: symbol.rparen.mcore
      pop: true
  typeexpr-pushed-breakeq:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breakeq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breakeq, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breakeq:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakeq]
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      pop: true
  typeexpr-pushed-breakin:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breakin]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breakin, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breakin:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakin]
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true
  typeexpr-pushed-breakdot:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breakdot]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breakdot, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breakdot:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakdot]
    - match: '[.]'
      scope: keyword.other.lamdot.mcore
      pop: true
  typeexpr-pushed-breakrsquare:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breakrsquare]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breakrsquare, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breakrsquare:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakrsquare]
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - match: '\]'
      scope: symbol.rsquare.mcore
      pop: true
  typeexpr-pushed-breaktuple:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrowcomma-or-breakrparen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrparen, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrowcomma-or-breakrparen:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breaktuple]
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [typeexpr-pushed-breaktuple]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - match: '\)'
      scope: symbol.rparen.mcore
      pop: true
  typeexpr-pushed-breakrecord:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrowcomma-or-breakrcurly, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrowcomma-or-breakrcurly:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breakrecord]
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - match: '\}'
      scope: symbol.rcurly.mcore
      pop: true
  typeexpr-pushed-breaksynbody:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breaksynbody]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breaksynbody, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breaksynbody:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breaksynbody]
    - include: top-lang-syn-body-pushed
  typeexpr-pushed-breaktoplevel:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{type_ident}})|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: keyword.directive.typename.mcore
        5: other.ident.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [typeexpr-pushed-continuearrow-or-breaktoplevel]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel]
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel, typeexpr-pushed-breakrsquare]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel, typeexpr-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [typeexpr-pushed-continuearrow-or-breaktoplevel, typeexpr-pushed-breakrecord, colon-pushed, identifier-pushed]
  typeexpr-pushed-continuearrow-or-breaktoplevel:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      set: [typeexpr-pushed-breaktoplevel]
    - include: top-level-pushed

  optidenttype-pushed-breakeq:
    - match: '(:)'
      scope: symbol.colon.mcore
      set: [typeexpr-pushed-breakeq]
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      pop: true
  optidenttype-pushed-breakin:
    - match: '(:)'
      scope: symbol.colon.mcore
      set: [typeexpr-pushed-breakin]
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true
  optidenttype-pushed-breakdot:
    - match: '(:)'
      scope: symbol.colon.mcore
      set: [typeexpr-pushed-breakdot]
    - match: '[.]'
      scope: keyword.other.lamdot.mcore
      pop: true
  optidenttype-pushed-breaktoplevel:
    - match: '(:)'
      scope: symbol.colon.mcore
      set: [typeexpr-pushed-breaktoplevel]
    - include: top-level-pushed

  opttypetype-pushed-breakin:
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      set: [typeexpr-pushed-breakin]
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true
  opttypetype-pushed-breaktoplevel:
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      set: [typeexpr-pushed-breaktoplevel]
    - include: top-level-pushed

  ###                     ###
  ### Pattern Expressions ###
  ###                     ###
  pattern-pushed-breakrightarrow:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakrightarrow]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakrightarrow]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakrightarrow]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakrightarrow]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakrightarrow, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakrightarrow-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakrightarrow-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakrightarrow]
  pattern-pushed-concatseq-or-breakrightarrow:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakrightarrow-cond, patternseq-pushed]
    - include: pattern-pushed-breakrightarrow-cond
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakrightarrow]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakrightarrow]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakrightarrow]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakrightarrow-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakrightarrow]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakrightarrow, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakrightarrow-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakrightarrow-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakrightarrow]
  pattern-pushed-concatident-or-breakrightarrow:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-pushseq-or-breakrightarrow-cond, identifier-pushed]
    - include: pattern-pushed-breakrightarrow-cond
  pattern-pushed-pushseq-or-breakrightarrow-cond:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakrightarrow-cond, patternseq-pushed]
    - include: pattern-pushed-breakrightarrow-cond
  pattern-pushed-breakrightarrow-cond:
    - include: rightarrow-pushed
    - match: '(\|)'
      scope: keyword.operator.or.mcore
      set: [pattern-pushed-breakrightarrow]
    - match: '(\&)'
      scope: keyword.operator.and.mcore
      set: [pattern-pushed-breakrightarrow]
  pattern-pushed-breakthen:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakthen]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakthen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakthen, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakthen-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakthen-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakthen]
  pattern-pushed-concatseq-or-breakthen:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakthen-cond, patternseq-pushed]
    - include: pattern-pushed-breakthen-cond
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakthen]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakthen]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakthen-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakthen]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakthen, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakthen-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakthen-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakthen]
  pattern-pushed-concatident-or-breakthen:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-pushseq-or-breakthen-cond, identifier-pushed]
    - include: pattern-pushed-breakthen-cond
  pattern-pushed-pushseq-or-breakthen-cond:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakthen-cond, patternseq-pushed]
    - include: pattern-pushed-breakthen-cond
  pattern-pushed-breakthen-cond:
    - include: directive-then-pushed
    - match: '(\|)'
      scope: keyword.operator.or.mcore
      set: [pattern-pushed-breakthen]
    - match: '(\&)'
      scope: keyword.operator.and.mcore
      set: [pattern-pushed-breakthen]
  pattern-pushed-breakseq:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakseq]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakseq]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakseq, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakseq-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakseq-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakseq]
  pattern-pushed-concatseq-or-breakseq:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakseq-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - include: pattern-pushed-breakseq-cond
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakseq]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakseq]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakseq-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakseq]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakseq, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakseq-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakseq-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakseq]
  pattern-pushed-concatident-or-breakseq:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-pushseq-or-breakseq-cond, identifier-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - include: pattern-pushed-breakseq-cond
  pattern-pushed-pushseq-or-breakseq-cond:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakseq-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - include: pattern-pushed-breakseq-cond
  pattern-pushed-breakseq-cond:
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [pattern-pushed-breakseq]
    - meta_include_prototype: false
    - include: prototype-ignore-rsquare
    - match: '\]'
      scope: symbol.rsquare.mcore
      pop: true
    - match: '(\|)'
      scope: keyword.operator.or.mcore
      set: [pattern-pushed-breakseq]
    - match: '(\&)'
      scope: keyword.operator.and.mcore
      set: [pattern-pushed-breakseq]
  pattern-pushed-breaktuple:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breaktuple]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breaktuple]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breaktuple, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breaktuple-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breaktuple-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breaktuple]
  pattern-pushed-concatseq-or-breaktuple:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breaktuple-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - include: pattern-pushed-breaktuple-cond
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breaktuple]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breaktuple]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breaktuple-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breaktuple]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breaktuple, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breaktuple-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breaktuple-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breaktuple]
  pattern-pushed-concatident-or-breaktuple:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-pushseq-or-breaktuple-cond, identifier-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - include: pattern-pushed-breaktuple-cond
  pattern-pushed-pushseq-or-breaktuple-cond:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breaktuple-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - include: pattern-pushed-breaktuple-cond
  pattern-pushed-breaktuple-cond:
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [pattern-pushed-breaktuple]
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - match: '\)'
      scope: symbol.rparen.mcore
      pop: true
    - match: '(\|)'
      scope: keyword.operator.or.mcore
      set: [pattern-pushed-breaktuple]
    - match: '(\&)'
      scope: keyword.operator.and.mcore
      set: [pattern-pushed-breaktuple]
  pattern-pushed-breakrecord:
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakrecord]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakrecord]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakrecord]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakrecord]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakrecord, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakrecord-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakrecord-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakrecord]
  pattern-pushed-concatseq-or-breakrecord:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakrecord-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - include: pattern-pushed-breakrecord-cond
    - match: '[(]\s*[)]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '[{]\s*[}]'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '\[\s*\]'
      scope: constant.language.mcore
      set: [pattern-pushed-concatident-or-breakrecord]
    - match: '\b(true|false)\b'
      scope: constant.language.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9]([.][0-9]+)?(e|E)(\+|-)?[0-9]+'
      scope: constant.numeric.float.stdform.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9][.]([0-9])*'
      scope: constant.numeric.float.normal.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(-)?[0-9]+'
      scope: constant.numeric.integer.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [pattern-pushed-concatseq-or-breakrecord]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatseq-or-breakrecord]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '('')({{escapechar}})('')'
      captures:
        1: string.quote.single.mcore
        2: constant.character.escape.mcore
        3: string.quote.single.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '('')([^''\\])('')'
      scope: string.quote.single.mcore
      set: [pattern-pushed-breakrecord-cond]
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [pattern-pushed-concatident-or-breakrecord]
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-concatident-or-breakrecord, pattern-pushed-breakseq]
    - match: '\('
      scope: symbol.lparen.mcore
      set: [pattern-pushed-breakrecord-cond, pattern-pushed-breaktuple]
    - match: '\{'
      scope: symbol.lcurly.mcore
      set: [pattern-pushed-breakrecord-cond, pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - match: '[!]'
      scope: keyword.operator.not.mcore
      set: [pattern-pushed-breakrecord]
  pattern-pushed-concatident-or-breakrecord:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-pushseq-or-breakrecord-cond, identifier-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - include: pattern-pushed-breakrecord-cond
  pattern-pushed-pushseq-or-breakrecord-cond:
    - match: '([+][+])'
      scope: keyword.operator.concat.mcore
      set: [pattern-pushed-breakrecord-cond, patternseq-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - include: pattern-pushed-breakrecord-cond
  pattern-pushed-breakrecord-cond:
    - match: '[,]'
      scope: symbol.comma.mcore
      set: [pattern-pushed-breakrecord, eqoperator-pushed, identifier-pushed]
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - match: '\}'
      scope: symbol.rcurly.mcore
      pop: true
    - match: '(\|)'
      scope: keyword.operator.or.mcore
      set: [pattern-pushed-breakrecord]
    - match: '(\&)'
      scope: keyword.operator.and.mcore
      set: [pattern-pushed-breakrecord]

  patternseq-pushed:
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          pop: true
        - include: stringsymbol
        - meta_include_prototype: false
    - match: '\[\s*\]'
      scope: constant.language.mcore
      pop: true
    - match: '\['
      scope: symbol.lsquare.mcore
      set: [pattern-pushed-breakseq]

  ###                           ###
  ### Recursive Expression Body ###
  ###      (Not Top-Level)      ###
  ###                           ###
  recursive-body-pushed:
    - match: '\b(let)\b'
      scope: keyword.other.let.mcore
      set: [mexpr-pushed-breakrecbody, optidenttype-pushed-breakeq, identifier-pushed]
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true

  ###             ###
  ### Record Body ###
  ###             ###
  record-entry-pushed:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      set: [record-eqorwith-pushed]
    - match: '(#(?:var|con|type))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          set: [record-eqorwith-pushed]
        - include: stringsymbol
        - meta_include_prototype: false
    - meta_include_prototype: false
    - include: prototype-ignore-rcurly
    - match: '\}'
      scope: symbol.rcurly.mcore
      pop: true
    - include: mexpr-pushed-breakrecordwith
  record-eqorwith-pushed:
    - match: '\b(with)\b'
      scope: keyword.other.with.mcore
      set: [mexpr-pushed-breakrecordend, eqoperator-pushed, identifier-pushed]
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      set: [mexpr-pushed-breakrecordcontinued]

  record-proj-label-pushed:
    - include: identifier-pushed
    - include: uinteger-pushed

  ###                ###
  ### String Symbols ###
  ###                ###
  string-pushed:
    - match: '(")'
      scope: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          pop: true
        - include: stringsymbol
        - meta_include_prototype: false
  stringsymbol:
    - match: '{{escapechar}}'
      scope: constant.character.escape.mcore
    - match: '[^"\\]'
      scope: string.character.mcore

  ###                   ###
  ### Identifier Tokens ###
  ###                   ###
  identifier-pushed:
    - match: '\b(?:({{builtin_ident}})|({{reserved_ident}})|(_)|({{ident}}))\b'
      captures:
        1: support.function.builtin.ident.mcore
        2: invalid.illegal.reserved.ident.mcore
        3: keyword.other.ignored.ident.mcore
        4: other.ident.mcore
      pop: true
    - match: '(#(?:var|con|type|label))(")'
      captures:
        1: keyword.directive.identifier.mcore
        2: string.quote.double.mcore
      set:
        - match: '(")'
          scope: string.quote.double.mcore
          pop: true
        - include: stringsymbol
        - meta_include_prototype: false

  ###                ###
  ### Integer Tokens ###
  ###                ###
  uinteger-pushed:
  - match: '[0-9]+'
    scope: constant.numeric.integer.mcore
    pop: true

  ###                          ###
  ### Pushed Singleton Symbols ###
  ###                          ###
  eqoperator-pushed:
    - match: '(=)'
      scope: keyword.operator.assignment.mcore
      pop: true
  colon-pushed:
    - match: '(:)'
      scope: symbol.colon.mcore
      pop: true
  rparen-pushed:
    - meta_include_prototype: false
    - include: prototype-ignore-rparen
    - match: '\)'
      scope: symbol.rparen.mcore
      pop: true
  rightarrow-pushed:
    - match: '(->)'
      scope: keyword.operator.right-arrow.mcore
      pop: true
  directive-in-pushed:
    - match: '\b(in)\b'
      scope: keyword.other.in.mcore
      pop: true
  directive-then-pushed:
    - match: '\b(then)\b'
      scope: keyword.other.then.mcore
      pop: true
